@mixin loadingBase() {
  display: flex;
  height: $rectHeight * 5;
  padding-top: $rectHeight * 2;

  & > div {
    width: $totalWidth;
    height: $rectHeight;
    margin: 0 auto;
    perspective: $perspective;
    transform-origin: center;
    transform: translate3d(-3em, 0, 0);
    backface-visibility: hidden;

    & > div {
      position: relative;

      // rotate whole preloader to give it skewed look
      transform: rotateY(50deg) translateZ(1em);
      transform-origin: right;
      backface-visibility: hidden;

      & > div {
        position: relative;
        display: flex;
        animation: loading_container $time linear infinite;

        & > div {
          width: $rectWidth;
          height: $rectHeight;
          margin-right: $gutterWidth;
          background: $colorRed100;

          // disable backface visibility
          backface-visibility: hidden;

          // to remove jagged edges on transformed objects
          outline: 1px solid transparent;

          @for $i from 1 through $numberOfItems {
            &:nth-child(#{$i}) {
              animation: loading_rectangle#{$i} $time linear infinite;
            }
          }

          &:last-child {
            margin-right: 0;
          }
        }
      }
    }
  }

  @each $size, $width, $height, $gutterWidth, $perspective in $sizes {
    &[mode="#{$size}"] {
      height: $height * 5;
      padding-top: $height * 2;

      & > div {
        width: ($width + $gutterWidth) * $numberOfItems - $gutterWidth;
        height: $height;
        perspective: $perspective;

        & > div > div {
          animation: loading_container_#{$size} $time linear infinite;

          & > div {
            width: $width;
            height: $height;
            margin-right: $gutterWidth;

            @if $size == 'tiny' {
              transform: translate3d(-$gutterWidth / 2, 0, 0);
            }
          }
        }
      }
    }
  }

  &[inline] {
    display: inline-flex;
    padding-left: 1em;
    margin-right: -2em;
    height: auto;
    padding-top: 0;
    vertical-align: middle;
  }
}