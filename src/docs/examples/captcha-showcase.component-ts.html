<span class="hljs-keyword">import</span> { Component, OnInit, Injector } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/core'</span>;
<span class="hljs-keyword">import</span> { FormGroup, FormControl, Validators, AbstractControl } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/forms'</span>;
<span class="hljs-keyword">import</span> { Subscription } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;
<span class="hljs-keyword">import</span> { RECAPTCHA_LANGUAGE } <span class="hljs-keyword">from</span> <span class="hljs-string">'projects/sbb-angular/src/public_api'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> FormModel {
  captcha?: <span class="hljs-built_in">string</span>;
}

<span class="hljs-meta">@Component</span>({
  selector: <span class="hljs-string">'sbb-captcha-showcase'</span>,
  templateUrl: <span class="hljs-string">'./captcha-showcase.component.html'</span>,
  styleUrls: [<span class="hljs-string">'./captcha-showcase.component.scss'</span>],
  providers: [{provide: RECAPTCHA_LANGUAGE, useValue:<span class="hljs-string">'fr'</span>}]
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> CaptchaShowcaseComponent <span class="hljs-keyword">implements</span> OnInit {

  basicCaptchaResponse: <span class="hljs-built_in">string</span>;

  formModel: FormModel = {};

  formCaptcha: FormGroup;

  captchaSubscription: Subscription;

  testSiteKey:<span class="hljs-built_in">string</span>;

  captcha: FormControl = <span class="hljs-keyword">new</span> FormControl(<span class="hljs-string">''</span>,[Validators.required]);

  <span class="hljs-keyword">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> injector: Injector</span>) {

    <span class="hljs-keyword">this</span>.testSiteKey = <span class="hljs-keyword">this</span>.injector.get(<span class="hljs-string">'testSiteKey'</span>);

  }

  ngOnInit() {

    <span class="hljs-keyword">this</span>.formCaptcha = <span class="hljs-keyword">new</span> FormGroup({

      captcha: <span class="hljs-keyword">this</span>.captcha

    });

    <span class="hljs-keyword">this</span>.captchaSubscription = <span class="hljs-keyword">this</span>.formCaptcha.get(<span class="hljs-string">'captcha'</span>).valueChanges.subscribe(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {

      <span class="hljs-built_in">console</span>.log(value);
    });

  }
  resolved(captchaResponse: <span class="hljs-built_in">string</span>) {
    <span class="hljs-keyword">this</span>.basicCaptchaResponse = captchaResponse;
  }

  resetForm() {

    <span class="hljs-keyword">this</span>.formCaptcha.reset();
  }


}
